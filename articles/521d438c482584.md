---
title: "Ubuntuのサーバーを作成したあとやるべきこと"
emoji: "🗺️"
type: "tech"
topics:
  - "linux"
  - "ubuntu"
  - "shell"
published: true
published_at: "2022-07-22 17:28"
---

以下の手順は、Ubuntuのサーバーを作成して“さあ使うぞ”となったときにまずやっておきたい作業のまとめです。いわば、引っ越し後に最低限準備すべき「歯ブラシとトイレットペーパーとネット環境（←重要）」みたいな感じですね。  
コマンドを打ち間違えると、床にコーヒーこぼした並みに面倒なことになるかもしれないので、落ち着いて実行しましょう！

---

## 1. 新しいユーザーを作成する

```shell
adduser user_name
```
- `user_name` は自分の名前、もしくは使いたいユーザー名に置き換えてください。  
- **注意**: `adduser` と `useradd` は別物なので、名前が似ていても間違えないようにしましょう。`useradd` は存在こそしますが、下手に使うとトラブルの元です。

---

## 2. 新しいユーザーに sudo 権限を付与する

```shell
gpasswd -a user_name sudo
```
- 先ほど作った `user_name` を指定しましょう。  
- これで、新しいユーザーが「管理者権限（sudo）が使える偉い人」になります。

---

## 3. SSH のパスワードでのアクセスを許可する

パスワード認証は証明書認証より安全性がやや落ちますが、「実験環境＆複雑なパスワードならOK！」という場合も。  
（本番環境だと鍵認証がおすすめです！）

```shell
sudo vim /etc/ssh/sshd_config
```
![](https://storage.googleapis.com/zenn-user-upload/2c775f8916c3-20220722.png)

- `PasswordAuthentication no` を `yes` に変更して保存します。  
- これでパスワード認証でログインできるようになります。

---

## 4. ついでに SSH セッションが自動的に切れないようにする

サーバーにログインしっぱなしで作業したいのに、突然「プツッ」と切れると悲しいですよね。  
そんなときは以下の設定で自動切断を伸ばしておきましょう。

```shell
sudo vim /etc/ssh/sshd_config
```
![](https://storage.googleapis.com/zenn-user-upload/104f84350f00-20220722.png)

- `ClientAliveInterval` を `120` にする  
- `ClientAliveCountMax` を `3` にする  

セッションの自動切断をちょっと緩やかにしてくれます。

---

## 5. シェルを bash に変更する

なぜか Ubuntu ではデフォルトが `sh` の場合があるので、慣れた `bash` に変更します。
```shell
chsh -s /bin/bash user_name
```
- もちろん、シェルを zsh や fish にする選択肢もありますが、ひとまず bash がおすすめ。

---

## 6. sshd を再起動する

SSH 関連の設定を変更したら、忘れずに再起動！
```shell
sudo systemctl restart sshd
```

---

## 7. 今のグローバル IP を確認する

「今どこから見られてるの？」を把握しておきましょう。
```shell
curl inet-ip.info
```
- 自分のグローバル IP アドレスが表示されます。

---

## 8. 時間があったら apt をアップグレードしよう

いつの間にか更新が溜まっていることが多いので、ゆとりがあれば実行しましょう。
```shell
sudo apt update
sudo apt upgrade
```
- `sudo apt update` と `sudo apt upgrade` をセットで走らせておけば、パッケージ類が最新になります。  
- たまに面倒な依存関係で止まる場合もあるので、状況を見ながら適宜対応していきましょう。

---

以上が、Ubuntu インストール直後にやっておきたい初期設定＆便利設定です。  
これらを済ませれば、あなたの Ubuntu ライフがかなり快適になるはず。  
あとは好きな開発ツールを入れて、楽しいサーバー生活をどうぞ！